<!doctype html>
<html lang="en">
<head><meta charset="utf-8"/>
<link rel="shortcut icon" href="/favicon.ico"/>
<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"/>
<meta name="theme-color" content="#000000"/>
<title>Oasis</title>
</head>
<body></body>
<script>
var abi = [{"constant":false,"inputs":[{"name":"_moduleName","type":"string"},{"name":"_moduleVersion","type":"string"},{"name":"_contractName","type":"string"},{"name":"_contractVersion","type":"string"}],"name":"register","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getErrno","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_str","type":"string"},{"name":"_str2","type":"string"},{"name":"_str3","type":"string"}],"name":"log","outputs":[{"name":"_ret","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_str","type":"string"},{"name":"_addr","type":"address"}],"name":"log","outputs":[{"name":"_ret","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_number","type":"string"}],"name":"deleteByNumber","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_str","type":"string"},{"name":"_i","type":"int256"}],"name":"log","outputs":[{"name":"_ret","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_moduleName","type":"string"},{"name":"_moduleVersion","type":"string"},{"name":"_newOwner","type":"address"}],"name":"changeModuleRegisterOwner","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_moduleName","type":"string"},{"name":"_moduleVersion","type":"string"}],"name":"register","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_str","type":"string"}],"name":"log","outputs":[{"name":"_ret","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"kill","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_str","type":"string"},{"name":"_str2","type":"string"}],"name":"log","outputs":[{"name":"_ret","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getSender","outputs":[{"name":"_ret","type":"string"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"listAll","outputs":[{"name":"_json","type":"string"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_moduleName","type":"string"},{"name":"_moduleVersion","type":"string"},{"name":"_contractName","type":"string"},{"name":"_contractVersion","type":"string"},{"name":"_newOwner","type":"address"}],"name":"changeContractRegisterOwner","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_name","type":"string"},{"name":"_key","type":"string"},{"name":"_value","type":"string"}],"name":"writedb","outputs":[{"name":"_ret","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"getOwner","outputs":[{"name":"_ret","type":"string"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_str","type":"string"},{"name":"_ui","type":"uint256"}],"name":"log","outputs":[{"name":"_ret","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_number","type":"string"},{"name":"_name","type":"string"},{"name":"_price","type":"string"},{"name":"_author","type":"string"},{"name":"_remark","type":"string"}],"name":"add","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"inputs":[],"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_errno","type":"uint256"},{"indexed":false,"name":"_info","type":"string"}],"name":"Notify","type":"event"}];
var contractAddress = '0x2c3cad4cd68746bfde8e73167f067185830c59e6';
window.addEventListener('load', async () => {
    if (window.ethereum) {
             alert(1);
		window.web3 = new Web3(ethereum);
            try {
                await ethereum.enable();
                let contract = web3.eth.contract(abi).at(contractAddress)
                var balance = contract.listAll.call()
                alert(balance);

            } catch (error) {
                  alert('连接错误');
                  alert(error);
                  alert(error.message);
            }
    } else {
        alert(3);
    }

});
</script>
</html>
